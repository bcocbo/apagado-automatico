# Trivy configuration for comprehensive security scanning
# This file configures Trivy behavior for the namespace auto-shutdown system

# Global settings
format: json
output: trivy-report.json
exit-code: 1
severity: CRITICAL,HIGH,MEDIUM,LOW

# Scanning options
scan:
  # Skip files and directories
  skip-files:
    - "**/*.test.js"
    - "**/*.test.ts"
    - "**/*.test.py"
    - "**/test_*.py"
    - "**/tests/**"
    - "**/__tests__/**"
    - "**/node_modules/**"
    - "**/build/**"
    - "**/dist/**"
    - "**/coverage/**"
    - "**/.git/**"
    - "**/.vscode/**"
    - "**/.idea/**"
  
  # Skip directories
  skip-dirs:
    - node_modules
    - .git
    - .vscode
    - .idea
    - build
    - dist
    - coverage
    - __pycache__
    - .pytest_cache
    - .mypy_cache

# Vulnerability scanning
vulnerability:
  # Vulnerability types to scan
  type: os,library
  
  # Ignore unfixed vulnerabilities
  ignore-unfixed: true
  
  # Ignore policy
  ignore-policy: .trivyignore

# Secret scanning
secret:
  # Secret scanning configuration
  config: .trivy/secret.yaml

# Configuration scanning
config:
  # Configuration file types to scan
  file-patterns:
    - "*.yaml"
    - "*.yml"
    - "*.json"
    - "Dockerfile*"
    - "*.tf"
    - "*.hcl"
  
  # Policy bundles
  policy:
    - "appshield"
    - "kubernetes"
    - "docker"

# License scanning
license:
  # License categories to flag
  forbidden:
    - GPL-2.0
    - GPL-3.0
    - AGPL-3.0
  
  # License categories to allow
  allowed:
    - MIT
    - Apache-2.0
    - BSD-3-Clause
    - ISC

# Database settings
db:
  # Skip database update
  skip-update: false
  
  # Database repository
  repository: ghcr.io/aquasecurity/trivy-db
  
  # Java database repository
  java-repository: ghcr.io/aquasecurity/trivy-java-db

# Cache settings
cache:
  # Cache directory
  dir: ~/.cache/trivy
  
  # Clear cache before scanning
  clear: false

# Report settings
report:
  # Report format
  format: json
  
  # Template for custom reports
  template: "@contrib/html.tpl"
  
  # Dependency tree
  dependency-tree: true
  
  # List all packages
  list-all-pkgs: false

# Timeout settings
timeout: 5m0s

# Debug settings
debug: false
quiet: false